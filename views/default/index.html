<!DOCTYPE html>
<html>
    <head>
        <title>ClickABit</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <link rel="shortcut icon" href="{{=URL('static', 'images/favicon.ico')}}" type="image/x-icon">
        <link rel="apple-touch-icon" href="{{=URL('static', 'images/favicon.ico')}}">

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <!-- Optional theme -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
        <!-- Off-canvas -->
        <link rel="stylesheet" href="{{=URL('static', 'css/offcanvas.css')}}">
        <!-- Custom styles -->
        <link rel="stylesheet" href="{{=URL('static', 'css/styles.css')}}">

    </head>
    <body>

        <!-- TOP BAR NAV ================================================== -->
        <div class="navbar navbar-fixed-top navbar-inverse" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="offcanvas">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="{{=URL('default', 'index')}}">ClickABit</a>
                    <p class="navbar-text pull-right" href="#">UniqueID: {{=ip}}</p>

                </div>
            </div><!-- /.container -->
        </div><!-- /.navbar -->

        <!-- Main jumbotron for a primary marketing message or call to action -->
        <div id="jumbotron" class="jumbotron">
            <div class="container">
                <h1>Wth is ClickABit?</h1>
                <p>ClickABit is a "Bitcoin Lottery" system, combining <a href="https://bitcoin.org/">Bitcoin</a> with <a href="http://www.reddit.com/r/incremental_games">incremental clicker games</a>. Every click of the button below produces a <a href="https://en.bitcoin.it/wiki/Nonce">nonce</a> generated by a combination of a unique device identifier and the current timestamp. This nonce is used to attempt to <a href="https://en.bitcoin.it/wiki/Mining">mine</a> a <a href="https://en.bitcoin.it/wiki/Block">block</a> on the Bitcoin network. If the attempt is successful and the network accepts the block, the <a href="https://en.bitcoin.it/wiki/Mining#Reward">reward</a> of (currently) 25BTC gets awarded to you, directly.</p>
                <p>Currently, UniqueID = your IP. To be updated...</p>
                <p>Refer to the <a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm" target="#">block hashing algorithm</a> for more details.</p>
                <p><a class="btn btn-primary btn-lg" role="button" href={{=URL('default', 'info')}}>Learn more &raquo;</a></p>
            </div>
        </div>

        <div class="container">
            <!-- <div class="row row-offcanvas row-offcanvas-left"> -->
            <div class="row">

                <!-- MAIN CENTER ================================================== -->
                <div class="col-lg-6">
                    <!-- Clicker ================================================== -->
                    <button id="clicker" class="btn btn-lg btn-primary">Click</button>
                    <ol id="logs">
                    </ol>
                </div><!-- /.main -->

            </div><!--/row-->
        <div>

        <!-- JQuery ================================================== -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

        <!-- Bootstrap Latest compiled and minified JavaScript ================================================== -->
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <!-- Bootstrap off-canvas ================================================== -->
        <script src="{{=URL('static', 'js/offcanvas.js')}}"></script>

        <!-- AngularJS ================================================== -->
        <!-- <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular.min.js"></script> -->

        <script>
            // TODO: Figure out better unique ID than IP
            var uniqueId = 1;
            var timestamp;

            $("#clicker").click(function() {

                $("#jumbotron").fadeOut();

                timestamp = Date.now();
                $.ajax({
                    type: "POST",
                    url: "{{=URL('default', 'submitattempt.json')}}",
                    data: {
                        "uniqueId": uniqueId,
                        "timestamp": timestamp
                    },
                    dataType: "json",
                    success: function(data) {
                        console.log(data);
                        $("#logs").prepend("<li>Timestamp:" + timestamp + ", Nonce: " + data.nonce + "</li>");
                    },
                    error: function() {
                        console.log("error");
                    }
                });
            });
        </script>

    </body>
</html>